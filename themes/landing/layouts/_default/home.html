{{/* layouts/_default/home.html */}}
{{ define "main" }}
    <section class="section hero wrapper">
        <div class="container text-center">
          <h1 class="hero-title">
            <span class="accent italic">Al√≠vio</span> para as suas dores e tens√µes
          </h1>

          <p class="hero-text">
            As nossas massagens terap√™uticas e relaxantes proporcionam uma sensa√ß√£o
            de bem-estar e equil√≠brio. Se procura aliviar as suas dores e tens√µes,
            por favor, entre em contato connosco.
          </p>
          
          <a href="#contacto" class="btn btn-large">
            Envie-nos uma mensagem
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#arrow-right"></use>
            </svg>
          </a>
        </div>
      </section>
  
    <!-- About Section -->
    <section class="bg-white py-16">
      <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
        <!-- Imagem Background -->
        <div class="aspect-video bg-primary-900">
          <img src="/images/image11.jpg" alt="Gabinete de massagem" class="w-full h-full object-cover">
        </div>
        
        <div>
          <h2 class="font-display text-4xl text-neutral-700 mb-6">
            Cumprimentos, sou Jo√£o Paulo Goulart
          </h2>
          
          <p class="font-sans text-neutral-700 mb-8">
            Ofere√ßo servi√ßos de massagem profissionais e personalizados, tanto no
            nosso espa√ßo como no conforto do seu lar, com a possibilidade de servi√ßo
            ao domic√≠lio. O nosso ambiente est√° devidamente equipado para melhorar o
            seu bem-estar.
          </p>
  
          <a href="#contacto" 
            class="inline-flex items-center bg-primary-300 text-white px-7 py-3.5 rounded-md uppercase tracking-wider text-sm hover:scale-95 transition-transform">
            Envie-nos uma mensagem
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </section>
  
    <!-- Services Section -->
    <section class="py-16">
      <div class="container mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="font-display text-5xl text-neutral-700 mb-6">
            Traz <span class="text-primary-300 italic">al√≠vio</span> √†s suas dores e tens√µes
          </h2>
          <p class="font-sans text-neutral-700">
            O seu bem-estar √© a nossa prioridade. Descontraia-se e deixe-nos cuidar
            de si. Merece este momento de tranquilidade e al√≠vio.
          </p>
        </div>
  
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <!-- Massagem Sueca -->
          <div class="bg-white p-8 rounded-lg shadow-lg">
            <h3 class="font-display text-2xl text-neutral-700 mb-4">Massagem Sueca</h3>
            <p class="text-neutral-500 mb-6">
              Massagem ao corpo inteiro usando movimentos suaves e fluidos. Ajudam a
              melhorar a circula√ß√£o e proporcionar o bem-estar.
            </p>
            <a href="#agendar" 
               class="inline-flex items-center text-primary-600 hover:text-primary-700 px-5 py-2.5 text-sm uppercase tracking-wider">
              Agende agora
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
  
          <!-- Massagem Terap√™utica -->
          <div class="bg-white p-8 rounded-lg shadow-lg">
            <h3 class="font-display text-2xl text-neutral-700 mb-4">Massagem Terap√™utica</h3>
            <p class="text-neutral-500 mb-6">
              A terapia certa para aliviar dores constantes. Utilizamos t√©cnicas
              comprovadas para visar as suas √°reas problem√°ticas.
            </p>
            <a href="#agendar"
               class="inline-flex items-center text-primary-600 hover:text-primary-700 px-5 py-2.5 text-sm uppercase tracking-wider">
              Agende agora
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
  
          <!-- Servi√ßo Ao Domic√≠lio -->
          <div class="bg-white p-8 rounded-lg shadow-lg">
            <h3 class="font-display text-2xl text-neutral-700 mb-4">Servi√ßo Ao Domic√≠lio</h3>
            <p class="text-neutral-500 mb-6">
              Caso lhe seja inconveniente deslocar-se, ou se preferir o conforto do
              seu pr√≥prio espa√ßo, n√≥s podemos deslocar-nos at√© si, seja em sua casa,
              no escrit√≥rio ou em qualquer outro local.
            </p>
            <a href="#agendar"
               class="inline-flex items-center text-primary-600 hover:text-primary-700 px-5 py-2.5 text-sm uppercase tracking-wider">
              Agende agora
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </section>
  
    <!-- Contact Section -->
    <section id="contacto" class="bg-white py-16">
      <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
        <div class="space-y-6">
          <h2 class="font-display text-4xl text-neutral-700">
            Sente dores e tens√µes no corpo?
          </h2>
          <p class="text-neutral-700">
            Ligue e explique melhor o que sente üëâ 
            <a href="tel:00351937543312" class="text-primary-300 font-bold">+351 937 543 312</a>
            <br/>
            Ou deixe abaixo os seus detalhes.
            <br/>
            <span class="text-primary-300 italic">- Jo√£o Paulo Goulart -</span>
          </p>
        </div>

        <form id="form01" method="post" action="form.php" class="space-y-6">
          <!-- CSRF Token -->
          <input type="hidden" name="csrf_token" id="csrf_token">
    
          <!-- Form Fields -->
          <div class="space-y-4">
            <input type="text" name="name" id="name" placeholder="Como se chama?"
                   class="w-full px-4 py-3 rounded-md border border-neutral-200 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"
                   maxlength="100" required>
            
            <input type="email" name="email" id="email" placeholder="Email"
                   class="w-full px-4 py-3 rounded-md border border-neutral-200 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"
                   maxlength="100" required>
            
            <input type="tel" name="phone" id="phone" placeholder="N√∫mero de telem√≥vel"
                   class="w-full px-4 py-3 rounded-md border border-neutral-200 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"
                   maxlength="15" required>
            
            <textarea name="message" id="message" placeholder="Como √© que a dor lhe dificulta?"
                      class="w-full px-4 py-3 rounded-md border border-neutral-200 focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 h-32"
                      maxlength="3000" required></textarea>
          </div>
    
          <!-- Feedback Message -->
          <div id="form-feedback" class="hidden"></div>
    
          <!-- Submit Button -->
          <button type="submit" id="submitButton"
                  class="inline-flex items-center bg-primary-300 text-white px-7 py-3.5 rounded-md uppercase tracking-wider text-sm hover:scale-95 transition-transform">
            <span>Enviar</span>
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </button>
        </form>

        <script>
          document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('form01');
            const submitButton = document.getElementById('submitButton');
            const feedback = document.getElementById('form-feedback');
            
            // Fun√ß√£o para mostrar feedback
            function showFeedback(message, type) {
              feedback.textContent = message;
              feedback.classList.remove('hidden', 'text-red-500', 'text-green-500', 'text-neutral-500');
              feedback.classList.add(`text-${type}-500`);
            }

            // Fun√ß√£o para validar o formul√°rio
            function validateForm() {
              const errors = [];
              
              const name = form.name.value.trim();
              const email = form.email.value.trim();
              const phone = form.phone.value.trim();
              const message = form.message.value.trim();

              // Valida√ß√£o do nome
              if (!name || name.length > 100) {
                errors.push('O nome √© obrigat√≥rio e deve ter no m√°ximo 100 caracteres.');
              }
              
              // Valida√ß√£o do email
              if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                errors.push('Por favor, insira um email v√°lido.');
              }
              
              // Valida√ß√£o do telefone
              if (!phone || phone.length > 15) {
                errors.push('O n√∫mero de telem√≥vel √© obrigat√≥rio e deve ter no m√°ximo 15 d√≠gitos.');
              }
              
              // Valida√ß√£o da mensagem
              if (!message || message.length > 3000) {
                errors.push('A mensagem √© obrigat√≥ria e deve ter no m√°ximo 3000 caracteres.');
              }

              if (errors.length > 0) {
                showFeedback(errors.join('<br>'), 'red');
                return false;
              }

              feedback.classList.add('hidden');
              return true;
            }

            // Buscar o token CSRF apenas quando o formul√°rio for focado
            form.addEventListener('focusin', async () => {
              if (!document.getElementById('csrf_token').value) {
                try {
                  const response = await fetch('/php/get_csrf_token.php');
                  const data = await response.json();
                  document.getElementById('csrf_token').value = data.csrf_token;
                } catch (error) {
                  console.error('Erro ao obter o token CSRF:', error);
                  showFeedback('Erro ao preparar o formul√°rio. Por favor, recarregue a p√°gina.', 'red');
                }
              }
            }, { once: true });

            // Manipular o envio do formul√°rio
            form.addEventListener('submit', async (event) => {
              event.preventDefault();
              
              if (!validateForm()) {
                return;
              }

              submitButton.disabled = true;
              const buttonText = submitButton.querySelector('span');
              const originalText = buttonText.textContent;
              buttonText.textContent = 'A enviar...';
              showFeedback('A processar seu pedido...', 'neutral');

              try {
                const response = await fetch(form.action, {
                  method: 'POST',
                  body: new FormData(form),
                  headers: {
                    'Accept': 'application/json'
                  }
                });

                const result = await response.json();
                
                if (response.ok) {
                  showFeedback('Mensagem enviada com sucesso!', 'green');
                  form.reset();
                } else {
                  throw new Error(result.error || 'Erro ao enviar mensagem');
                }
              } catch (error) {
                showFeedback(error.message, 'red');
                console.error('Erro no envio do formul√°rio:', error);
              } finally {
                submitButton.disabled = false;
                buttonText.textContent = originalText;
              }
            });
          });
        </script>
      </div>
    </section>
  
    <!-- Testimonials Section -->
    <section class="py-16">
      <h2 class="text-5xl font-display text-neutral-700 text-center mb-12">
        Clientes <span class="text-primary-300 italic">satisfeitos</span> todos os dias
      </h2>
      <div id="testimonials-widget" class="container mx-auto px-6">
        <!-- Widget content -->
      </div>
    </section>
  </div>
  {{ end }}